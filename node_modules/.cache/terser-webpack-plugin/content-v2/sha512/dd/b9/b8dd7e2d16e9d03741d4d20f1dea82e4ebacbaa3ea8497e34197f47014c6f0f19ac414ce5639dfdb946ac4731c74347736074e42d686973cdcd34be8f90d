{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{393:function(t,e,o){\"use strict\";o.r(e);var r=o(27),n=Object(r.a)({},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[o(\"h1\",{attrs:{id:\"编写一个简单的-loader-和-plugin\"}},[o(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#编写一个简单的-loader-和-plugin\"}},[t._v(\"#\")]),t._v(\" 编写一个简单的 loader 和 plugin\")]),t._v(\" \"),o(\"h2\",{attrs:{id:\"loader-编写\"}},[o(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#loader-编写\"}},[t._v(\"#\")]),t._v(\" loader 编写\")]),t._v(\" \"),o(\"p\",[o(\"code\",[t._v(\"loader\")]),t._v(\"就是一个函数的 javascript 模块，第一个参数为 webpack 配置里\"),o(\"code\",[t._v(\"rules\")]),t._v(\"匹配的文件内容，可以使用\"),o(\"code\",[t._v(\"loader-utils\")]),t._v(\"获取从配置中传入\"),o(\"code\",[t._v(\"loader\")]),t._v(\"的参数。\")]),t._v(\" \"),o(\"p\",[t._v(\"以下例子可以将文件里的所有\"),o(\"code\",[t._v(\"console.log\")]),t._v(\"打包变成\"),o(\"code\",[t._v(\"console.error\")])]),t._v(\" \"),o(\"div\",{staticClass:\"language- extra-class\"},[o(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[o(\"code\",[t._v(\"    const loaderUtils = require('loader-utils');\\n\\n    module.exports = function(source) {\\n        const options = loaderUtils.getOptions(this);\\n        return source.replace('console.log', 'console.error');\\n    }\\n\\n\")])])]),o(\"p\",[t._v(\"我们可以编写 loader 对想要的文件源代码进行包装，比如添加全局的异常监控，国际化等等\")]),t._v(\" \"),o(\"p\",[o(\"a\",{attrs:{href:\"https://github.com/licop/webpack4.0_learn/tree/master/%E7%BC%96%E5%86%99loader/makeLoader\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"完整的 loader 源码\"),o(\"OutboundLink\")],1),t._v(\" \"),o(\"a\",{attrs:{href:\"https://webpack.docschina.org/api/loaders/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"更多关于 loader 查看\"),o(\"OutboundLink\")],1)]),t._v(\" \"),o(\"h2\",{attrs:{id:\"plugin-编写\"}},[o(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#plugin-编写\"}},[t._v(\"#\")]),t._v(\" plugin 编写\")]),t._v(\" \"),o(\"p\",[o(\"code\",[t._v(\"plugin\")]),t._v(\" 编写使用事件驱动发布订阅的方式进行编写，与 \"),o(\"code\",[t._v(\"loader\")]),t._v(\" 是一个函数不同，\"),o(\"code\",[t._v(\"plugin\")]),t._v(\" 是一个 \"),o(\"code\",[t._v(\"class\")]),t._v(\" 类\")]),t._v(\" \"),o(\"p\",[o(\"code\",[t._v(\"Compiler\")]),t._v(\" 模块是 \"),o(\"code\",[t._v(\"webpack\")]),t._v(\" 的主要引擎，它通过 CLI 传递的所有选项， 或者 \"),o(\"code\",[t._v(\"Node API\")]),t._v(\"，创建出一个 \"),o(\"code\",[t._v(\"compilation\")]),t._v(\" 实例。 它扩展(extend)自 \"),o(\"code\",[t._v(\"Tapable\")]),t._v(\" 类，用来注册和调用插件。 大多数面向用户的插件会首先在 \"),o(\"code\",[t._v(\"Compiler\")]),t._v(\" 上注册。\")]),t._v(\" \"),o(\"p\",[o(\"code\",[t._v(\"plugin\")]),t._v(\"的作用是在 webpack 的某个时刻执行某项功能，通过\"),o(\"code\",[t._v(\"compiler.hooks\")]),t._v(\"来触发某个时刻\")]),t._v(\" \"),o(\"p\",[t._v(\"以下例子打包之后生成一个版权文件\")]),t._v(\" \"),o(\"div\",{staticClass:\"language- extra-class\"},[o(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[o(\"code\",[t._v(\"class CopyrightWebpackPlugin {\\n\\n\\tapply(compiler) {\\n\\n\\t\\tcompiler.hooks.compile.tap('CopyrightWebpackPlugin', (compilation) => {\\n\\t\\t\\tconsole.log('compiler');\\n\\t\\t})\\n\\n\\t\\tcompiler.hooks.emit.tapAsync('CopyrightWebpackPlugin', (compilation, cb) => {\\n\\t\\t\\tcompilation.assets['copyright.txt']= {\\n\\t\\t\\t\\tsource: function() {\\n\\t\\t\\t\\t\\treturn 'copyright by licop'\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tsize: function() {\\n\\t\\t\\t\\t\\treturn 17;\\n\\t\\t\\t\\t}\\n\\t\\t\\t};\\n\\t\\t\\tcb();\\n\\t\\t})\\n\\t}\\n\\n}\\n\\n\")])])]),o(\"p\",[o(\"a\",{attrs:{href:\"https://github.com/licop/webpack4.0_learn/tree/master/%E7%BC%96%E5%86%99plugin/plugin\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"完整的 plugin 源码\"),o(\"OutboundLink\")],1),t._v(\" \"),o(\"a\",{attrs:{href:\"https://webpack.docschina.org/api/plugins/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"更多关于 plugin 查看\"),o(\"OutboundLink\")],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);","extractedComments":[]}