<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>关于 Nuxtjs | What is FE</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="构建自己的系统的 Web 前端知识体系">
    
    <link rel="preload" href="/assets/css/0.styles.41761744.css" as="style"><link rel="preload" href="/assets/js/app.af0360ee.js" as="script"><link rel="preload" href="/assets/js/2.5e2d37c1.js" as="script"><link rel="preload" href="/assets/js/50.a9f91cfe.js" as="script"><link rel="preload" href="/assets/js/3.b304fdc1.js" as="script"><link rel="prefetch" href="/assets/js/10.f43faa2b.js"><link rel="prefetch" href="/assets/js/11.e2c35893.js"><link rel="prefetch" href="/assets/js/12.dfd05a36.js"><link rel="prefetch" href="/assets/js/13.87ed6518.js"><link rel="prefetch" href="/assets/js/14.c7b475e3.js"><link rel="prefetch" href="/assets/js/15.57e3ed86.js"><link rel="prefetch" href="/assets/js/16.863ec29e.js"><link rel="prefetch" href="/assets/js/17.57282106.js"><link rel="prefetch" href="/assets/js/18.98e27032.js"><link rel="prefetch" href="/assets/js/19.cf247cb8.js"><link rel="prefetch" href="/assets/js/20.838cd8ea.js"><link rel="prefetch" href="/assets/js/21.48a143f0.js"><link rel="prefetch" href="/assets/js/22.98e68f8e.js"><link rel="prefetch" href="/assets/js/23.eeeb88f1.js"><link rel="prefetch" href="/assets/js/24.3daf31ef.js"><link rel="prefetch" href="/assets/js/25.9267b8e9.js"><link rel="prefetch" href="/assets/js/26.15fbd97c.js"><link rel="prefetch" href="/assets/js/27.c60697f0.js"><link rel="prefetch" href="/assets/js/28.a10966fe.js"><link rel="prefetch" href="/assets/js/29.96902884.js"><link rel="prefetch" href="/assets/js/30.0a887d2a.js"><link rel="prefetch" href="/assets/js/31.e1b5f426.js"><link rel="prefetch" href="/assets/js/32.bf0b6009.js"><link rel="prefetch" href="/assets/js/33.0b87977c.js"><link rel="prefetch" href="/assets/js/34.51d1ef25.js"><link rel="prefetch" href="/assets/js/35.a2dc28c1.js"><link rel="prefetch" href="/assets/js/36.5d047a49.js"><link rel="prefetch" href="/assets/js/37.38aa7903.js"><link rel="prefetch" href="/assets/js/38.5ef8a772.js"><link rel="prefetch" href="/assets/js/39.c0df05f4.js"><link rel="prefetch" href="/assets/js/4.226c83f7.js"><link rel="prefetch" href="/assets/js/40.1e6e3def.js"><link rel="prefetch" href="/assets/js/41.1c2e59d3.js"><link rel="prefetch" href="/assets/js/42.daa81e44.js"><link rel="prefetch" href="/assets/js/43.ea0ca51b.js"><link rel="prefetch" href="/assets/js/44.72bce777.js"><link rel="prefetch" href="/assets/js/45.f60ab22e.js"><link rel="prefetch" href="/assets/js/46.01437bed.js"><link rel="prefetch" href="/assets/js/47.32b9a867.js"><link rel="prefetch" href="/assets/js/48.91d471ce.js"><link rel="prefetch" href="/assets/js/49.1d8c30c7.js"><link rel="prefetch" href="/assets/js/5.a6acc31c.js"><link rel="prefetch" href="/assets/js/51.85bf0f19.js"><link rel="prefetch" href="/assets/js/52.26b36d08.js"><link rel="prefetch" href="/assets/js/53.47768d21.js"><link rel="prefetch" href="/assets/js/54.2474752b.js"><link rel="prefetch" href="/assets/js/55.c6bdacbd.js"><link rel="prefetch" href="/assets/js/56.d947e947.js"><link rel="prefetch" href="/assets/js/57.12fad0b8.js"><link rel="prefetch" href="/assets/js/58.a2d99751.js"><link rel="prefetch" href="/assets/js/59.ba21b46e.js"><link rel="prefetch" href="/assets/js/6.56200eb6.js"><link rel="prefetch" href="/assets/js/60.c9daaa86.js"><link rel="prefetch" href="/assets/js/61.b95a710f.js"><link rel="prefetch" href="/assets/js/62.fb7224b6.js"><link rel="prefetch" href="/assets/js/63.c1a36e21.js"><link rel="prefetch" href="/assets/js/64.3b7e3bbc.js"><link rel="prefetch" href="/assets/js/65.16ea9415.js"><link rel="prefetch" href="/assets/js/66.e7a5079a.js"><link rel="prefetch" href="/assets/js/67.6a2c27de.js"><link rel="prefetch" href="/assets/js/68.e5d7668f.js"><link rel="prefetch" href="/assets/js/69.14937744.js"><link rel="prefetch" href="/assets/js/7.ab8ffd39.js"><link rel="prefetch" href="/assets/js/70.d1e1374f.js"><link rel="prefetch" href="/assets/js/71.2d4f2bbc.js"><link rel="prefetch" href="/assets/js/72.ce0f1545.js"><link rel="prefetch" href="/assets/js/73.3c6928c2.js"><link rel="prefetch" href="/assets/js/8.f847aa7a.js"><link rel="prefetch" href="/assets/js/9.42f33289.js">
    <link rel="stylesheet" href="/assets/css/0.styles.41761744.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">What is FE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/programming-basics/编程模式/函数式编程.html" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/syntax&amp;API/HTML/关于HTML.html" class="nav-link">
  语法和API
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  网络和通讯
</a></div><div class="nav-item"><a href="/development-process/Git/git命令.html" class="nav-link">
  开发流程
</a></div><div class="nav-item"><a href="/engineering/webpack/webpack基础学习.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/runnnig-monitoring/安全/CSRF.html" class="nav-link">
  运行与监控
</a></div><div class="nav-item"><a href="/framework/React/关于react-hook.html" class="nav-link">
  前端框架
</a></div><div class="nav-item"><a href="/tool&amp;plugin/cross-env/关于cross-env.html" class="nav-link">
  常用工具与插件
</a></div><div class="nav-item"><a href="/server/ssr/服务器端渲染.html" class="nav-link">
  服务器端
</a></div><div class="nav-item"><a href="/more/" class="nav-link">
  技术广度
</a></div><div class="nav-item"><a href="https://github.com/licop/What_is_FE" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/programming-basics/编程模式/函数式编程.html" class="nav-link">
  编程基础
</a></div><div class="nav-item"><a href="/syntax&amp;API/HTML/关于HTML.html" class="nav-link">
  语法和API
</a></div><div class="nav-item"><a href="/network/" class="nav-link">
  网络和通讯
</a></div><div class="nav-item"><a href="/development-process/Git/git命令.html" class="nav-link">
  开发流程
</a></div><div class="nav-item"><a href="/engineering/webpack/webpack基础学习.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/runnnig-monitoring/安全/CSRF.html" class="nav-link">
  运行与监控
</a></div><div class="nav-item"><a href="/framework/React/关于react-hook.html" class="nav-link">
  前端框架
</a></div><div class="nav-item"><a href="/tool&amp;plugin/cross-env/关于cross-env.html" class="nav-link">
  常用工具与插件
</a></div><div class="nav-item"><a href="/server/ssr/服务器端渲染.html" class="nav-link">
  服务器端
</a></div><div class="nav-item"><a href="/more/" class="nav-link">
  技术广度
</a></div><div class="nav-item"><a href="https://github.com/licop/What_is_FE" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ssr</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/server/ssr/服务器端渲染.html" class="sidebar-link">服务器端渲染</a></li><li><a href="/server/ssr/关于 Nuxtjs.html" class="active sidebar-link">关于 Nuxtjs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#nuxtjs-介绍" class="sidebar-link">Nuxtjs 介绍</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#目录结构" class="sidebar-link">目录结构</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#视图-views" class="sidebar-link">视图 views</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#路由" class="sidebar-link">路由</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#获取异步数据" class="sidebar-link">获取异步数据</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#生命周期" class="sidebar-link">生命周期</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#中间件-middleware" class="sidebar-link">中间件 middleware</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#插件" class="sidebar-link">插件</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#meta-标签和-seo" class="sidebar-link">meta 标签和 SEO</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#使用-vuex" class="sidebar-link">使用 Vuex</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#使用-nuxtjs-实现-realworld-项目" class="sidebar-link">使用 Nuxtjs 实现 realworld 项目</a></li><li class="sidebar-sub-header"><a href="/server/ssr/关于 Nuxtjs.html#更多参考" class="sidebar-link">更多参考</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="关于-nuxtjs"><a href="#关于-nuxtjs" class="header-anchor">#</a> 关于 Nuxtjs</h1> <h2 id="nuxtjs-介绍"><a href="#nuxtjs-介绍" class="header-anchor">#</a> Nuxtjs 介绍</h2> <p><code>Nuxt.js</code> 是一个基于 Vue.js 的服务端渲染应用框架，它可以帮我们轻松的实现同构应用。至于为什么要实现同构应用，可以参考<a href="https://what-is-fe.licop.cn/server/ssr/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%B8%B2%E6%9F%93.html" target="_blank" rel="noopener noreferrer">服务器渲染<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>通过对客户端/服务端基础架构的抽象组织，<code>Nuxt.js</code> 主要关注的是应用的 <strong>UI 渲染</strong>。</p> <p><code>Nuxt.js</code>目标是创建一个灵活的应用框架，你可以基于它初始化新项目的基础结构代码，或者在已有 Node.js 项目中使用 <code>Nuxt.js</code>。
<code>Nuxt.js</code> 预设了利用 Vue.js 开发<strong>服务端渲染</strong>的应用所需要的各种配置。除此之外，<code>Nuxt.js</code>还提供了一种命令叫: <code>nuxt generate</code> ，为基于 Vue.js 的应用提供生成对应的静态站点的功能。</p> <p>作为框架，Nuxt.js 为 <code>客户端/服务端</code> 这种典型的应用架构模式提供了许多有用的特性，例如<strong>异步数据加载</strong>、<strong>中间件支持</strong>、<strong>布局支持</strong>等非常实用的功能。</p> <p>使用<code>Nuxt.js</code>的应用程序分别在服务器端（即 nodejs 环境）和客户端运行，在服务器端无法获取<code>document</code>和<code>window</code>对象，可以通过<code>process.server</code>和<code>process.client</code>判别应用正在运行的环境。</p> <h3 id="nuxt-js-的-ssr-应用渲染步骤"><a href="#nuxt-js-的-ssr-应用渲染步骤" class="header-anchor">#</a> Nuxt.js 的 SSR 应用渲染步骤</h3> <ol><li><strong>从浏览器到服务器</strong>
当浏览器发送初始请求时，它将访问 <code>Node.js</code> 内部服务器。 <code>Nuxt.js</code> 会生成 HTML，并执行其功能和钩子函数（例如， asyncData，nuxtServerInit 或 fetch。</li> <li><strong>从服务器到浏览器</strong>
浏览器使用生成的 HTML 从服务器接收呈现的页面。显示内容，Vue.js 开始渲染 dom。在此过程之后，页面是交互式的</li> <li><strong>浏览器到浏览器</strong>
使用<NuxtLink>在页面之间导航是在客户端完成的，因此除非您强制刷新浏览器，否则您不会再次访问服务器</NuxtLink></li></ol> <p>具体参考文档<a href="https://nuxtjs.org/docs/2.x/concepts/server-side-rendering" target="_blank" rel="noopener noreferrer">Server Side Rendering<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="特性"><a href="#特性" class="header-anchor">#</a> 特性</h3> <ul><li>基于 Vue.js,集成 <code>Vue</code>、<code>Vue Router</code>、<code>Vuex</code>、<code>Vue SSR</code></li> <li>自动代码分层</li> <li>服务端渲染</li> <li>强大的路由功能，支持异步数据</li> <li>静态文件服务</li> <li>ES2015+ 语法支持</li> <li>打包和压缩 JS 和 CSS</li> <li>HTML 头部标签管理</li> <li>本地开发支持热加载</li> <li>集成 ESLint</li> <li>支持各种样式预处理器: SASS、LESS、 Stylus 等等</li> <li>支持 HTTP/2 推送</li></ul> <p>压缩并 gzip 后，总代码大小为:57kb (如果使用了 Vuex 特性的话为 60kb)。
另外，<code>Nuxt.js</code> 使用 <code>Webpack</code> 和 <code>vue-loader</code> 、 <code>babel-loader</code> 来处理代码的自动化构建工作(如打包、代码分层、压缩等等)。</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>在项目中使用<code>Nuxt.js</code>有两种方法：</p> <ul><li>使用 <code>create-nuxt-app</code> 脚手架工具</li> <li>手动创建</li></ul> <p>具体安装方法步骤可以参考官方文档 <a href="https://zh.nuxtjs.org/docs/2.x/get-started/installation" target="_blank" rel="noopener noreferrer">Installation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h2> <p>以下是一个 <code>Nuxt.js</code> 应用程序的目录结构和介绍，这些目录和文件的名字没有额外的配置不要更改，具体可以参考文档<a href="https://zh.nuxtjs.org/docs/2.x/directory-structure/nuxt" target="_blank" rel="noopener noreferrer">目录结构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>
├── nuxtjs-demo
│   ├── .nuxt      构建目录，当你执行nuxt dev 和nuxt build时自动生成，部署SSR应用时需要
│   ├── assets     包含未编译的Stylus or Sass 样式文件，图片或者字体
│   ├── components 包含Vuejs的组件，可以在pages、layouts或者其他组件里重复使用
│   ├── content    通过@nuxtjs/content模块在其中写入Markdown，JSON，YAML和CSV文件，并可以通过api获取这些文件的信息
│   ├── dist       使用nuxt generate命令时动态生成的目录，包含生成的HTML和其他运行静态生成的Nuxt.js应用程序所必需的文件
│   ├── layouts    默认的视图布局文件目录
│   ├── middleware 中间件目录，中间件可以让你在page或者一组pages渲染之前运行一个自定义的函数
│   ├── modules    Nuxtjs官方模块和自定义模块，如 '@nuxtjs/axios'
│   ├── pages      包含应用程序的视图和路由，Nuxt.js 读取目录中所有.vue文件，自动生成路由配置
│   ├── plugins    插件目录，在Vuejs根应用实例化之前运行
│   ├── static     目录直接映射到服务的root，Nuxt会给该目录提供服务，目录里的文件可以通过项目根Url访问
│   ├── store      包含Vuex 的store文件
│   ├── nuxt.config.js nuxtjs应用程序的配置文件
│
</code></pre></div><h2 id="视图-views"><a href="#视图-views" class="header-anchor">#</a> 视图 views</h2> <p>视图(views)由 app.html 模板、一个 layout 布局文件和实际页面 page 组成。</p> <p><img src="/server/views.png" alt=""></p> <h3 id="app-html-模板"><a href="#app-html-模板" class="header-anchor">#</a> app.html 模板</h3> <p>app.html 模板是<code>Nuxt.js</code>应用页面的实际 HTML 框架, 可以为页面注入 head 和 body 的变量,这些变量都是自动生成的,可以通过在项目的源目录中创建一个 <code>app.html</code> 文件（默认情况下是根目录）来自定义 <code>Nuxt.js</code> 使用的 HTML 应用模板，以引入所需要的 js 和 css 文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">{{</span> <span class="token attr-name">HTML_ATTRS</span> <span class="token attr-name">}}</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span> <span class="token attr-name">{{</span> <span class="token attr-name">HEAD_ATTRS</span> <span class="token attr-name">}}</span><span class="token punctuation">&gt;</span></span>
    {{ HEAD }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">{{</span> <span class="token attr-name">BODY_ATTRS</span> <span class="token attr-name">}}</span><span class="token punctuation">&gt;</span></span>
    {{ APP }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>关于更多视图内容 参考文档<a href="https://zh.nuxtjs.org/docs/2.x/concepts/views" target="_blank" rel="noopener noreferrer">views<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h2> <p><code>Nuxt.js</code> 有两种配置路由的方式， 依据 pages 目录结构自动生成 <code>vue-router</code> 模块的路由配置和通过<code>nuxt.config.js</code>的 router 属性手动配置路由。</p> <h3 id="自动生成路由"><a href="#自动生成路由" class="header-anchor">#</a> 自动生成路由</h3> <p><strong>基础路由</strong></p> <p>假设 <code>pages</code> 的目录结构如下:</p> <div class="language- extra-class"><pre class="language-text"><code>pages/
--| user/
-----| index.vue
-----| one.vue
--| index.vue
</code></pre></div><p>那么，<code>Nuxt.js</code> 自动生成的路由配置如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token operator">:</span> <span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/index.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/user&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/user/index.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;user-one&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/user/one&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/user/one.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>动态路由</strong></p> <p>在 Nuxt.js 里面定义带参数的动态路由，需要创建对应的<strong>以下划线作为前缀</strong>的 Vue 文件 或 目录。 以下目录结构:</p> <div class="language- extra-class"><pre class="language-text"><code>pages/
--| _slug/
-----| comments.vue
-----| index.vue
--| users/
-----| _id.vue
--| index.vue
</code></pre></div><p><code>Nuxt.js</code> 生成对应的路由配置表为:</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token operator">:</span> <span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/index.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;users-id&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/users/:id?&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/users/_id.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;slug&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/:slug&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/_slug/index.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;slug-comments&quot;</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/:slug/comments&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/_slug/comments.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你会发现名称为 <code>users-id</code> 的路由路径带有 <code>:id?</code> 参数，表示该路由是可选的。如果你想将它设置为必 选的路由，需要在 <code>users/_id</code> 目录内创建一个 <code>index.vue</code> 文件。</p> <p><strong>嵌套路由</strong></p> <p>你可以通过 <code>vue-router</code> 的子路由创建 <code>Nuxt.js</code> 应用的嵌套路由。
创建内嵌子路由，你需要添加一个 Vue 文件，同时添加一个与该文件同名的目录用来存放子视图组件。</p> <blockquote><p>Warning: 别忘了在父组件( .vue 文件) 内增加 <nuxt-child></nuxt-child> 用于显示子视图内容。 假设文件结构如:</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>pages/
--| users/
-----| _id.vue
-----| index.vue
--| users.vue
</code></pre></div><p>Nuxt.js 自动生成的路由配置如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token operator">:</span> <span class="token punctuation">{</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&quot;/users&quot;</span><span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token string">&quot;pages/users.vue&quot;</span><span class="token punctuation">,</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          path<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
          component<span class="token operator">:</span> <span class="token string">&quot;pages/users/index.vue&quot;</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          path<span class="token operator">:</span> <span class="token string">&quot;:id&quot;</span><span class="token punctuation">,</span>
          component<span class="token operator">:</span> <span class="token string">&quot;pages/users/_id.vue&quot;</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token string">&quot;users-id&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="手动配置路由"><a href="#手动配置路由" class="header-anchor">#</a> 手动配置路由</h3> <p>在<code>extendRoutes</code>自定义路由规则，在添加路由配置之前，先清除 <code>Nuxt.js</code> 基于 <code>pages</code>目录默认生成的路由表规则</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// nuxt.config.js文件</span>
router<span class="token operator">:</span> <span class="token punctuation">{</span>
    linkActiveClass<span class="token operator">:</span> <span class="token string">'active'</span><span class="token punctuation">,</span>
    <span class="token comment">// 自定义路由规则</span>
    <span class="token function">extendRoutes</span><span class="token punctuation">(</span><span class="token parameter">routes<span class="token punctuation">,</span> resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 清除Nuxt.js基于pages目录默认生成的路由表规则</span>
      routes<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      routes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
          component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/layout'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          children<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 默认子路由</span>
              name<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/home/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'login'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/login/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/register'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'register'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/login/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/profile/:username'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'profile'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/profile/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/settings'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'settings'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/settings/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/editor/:slug'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'editArticle'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/editor/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/editor'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'newArticle'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/editor/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              path<span class="token operator">:</span> <span class="token string">'/article/:slug'</span><span class="token punctuation">,</span>
              name<span class="token operator">:</span> <span class="token string">'article'</span><span class="token punctuation">,</span>
              component<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'pages/article/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>更多关于路由配置参考<a href="https://zh.nuxtjs.org/docs/2.x/configuration-glossary/configuration-router" target="_blank" rel="noopener noreferrer">router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="watchequery"><a href="#watchequery" class="header-anchor">#</a> watcheQuery</h3> <p>使用 <code>watchQuery</code> 来设置查询字符串 <code>$route.query</code> 的监视。如果路由中，定义的字符串发生更改，则将调用所有组件方法（asyncData，fetch，validate，layout 等）。监视默认情况下处于禁用状态，以提高性能。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  watchQuery<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="获取异步数据"><a href="#获取异步数据" class="header-anchor">#</a> 获取异步数据</h2> <p><code>Nuxt.js</code> 支持在客户端应用（client-side）中加载数据的传统 Vue 模式，例如在组件的 <code>mounted（）</code>的钩子中获取数据。同时为了满足 SSR 应用的功能，<strong>页面内容有利于 SEO</strong> 和<strong>提升首屏渲染速度</strong>的特性，<code>Nuxt.js</code> 提供两个在服务端渲染期间调用的钩子函数<code>fetch</code>和<code>asyncData</code>。</p> <p>这样有助于 SEO 的数据信息就可以<code>fetch</code>和<code>asyncData</code>中获取在，显示到页面的 html 中了。</p> <h3 id="fetch"><a href="#fetch" class="header-anchor">#</a> fetch</h3> <p>在 Nuxt 2.12+版本中可以使用，可以在任意 <code>pages</code> 和 <code>components</code> 中使用</p> <h3 id="asyncdata"><a href="#asyncdata" class="header-anchor">#</a> asyncData</h3> <p><code>asyncData</code>只能在 pages 里使用，在首次加载在服务端调用，路由导航的的时候的客户端调用，<code>asyncData</code>中获取不到 vue 实例的 this，不过可以接收 Nuxt 的上下文<code>context</code>作为参数。<code>asyncData</code>中返回的数据会自动和组件的 data 属性合并。</p> <p><img src="/server/context.svg" alt=""></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nuxt-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/about<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>about<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nuxt-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span> <span class="token attr-name">:posts</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>posts<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Foo <span class="token keyword">from</span> <span class="token string">&quot;@/components/Foo&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;HomePage&quot;</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    Foo<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 当你想要动态页面内容有利于seo或者提升首屏渲染速度的时候就在asyncData中发请求</span>
  <span class="token keyword">async</span> <span class="token function">asyncData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;asyncData&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// asyncData没有this，只能用于请求数据，在组价初始化之前被调用</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      methods<span class="token operator">:</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span>
      url<span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000/data.json&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      posts<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>posts<span class="token punctuation">,</span>
      title<span class="token operator">:</span> res<span class="token punctuation">.</span>res<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>关于更多获取异步数据参考<a href="https://zh.nuxtjs.org/docs/2.x/features/data-fetching" target="_blank" rel="noopener noreferrer">Data Fetching<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h2> <p>下面是<code>Nuxt.js</code>的生命周期 hooks 在服务器端和客户端的调用情况
<img src="/server/nuxt%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" alt=""></p> <h2 id="中间件-middleware"><a href="#中间件-middleware" class="header-anchor">#</a> 中间件 middleware</h2> <p>中间件使你可以可在渲染一个页面或一组页面（layout）之前运行的自定义 function，function 接收上下文参数。</p> <p>例如,验证是否登录的中间件,如果没登录重定向到登录页面</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// /middleware/authenticated.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store<span class="token punctuation">,</span> redirect <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当我们的页面需要这个功能时，直接在页面中引用就好了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// /pages/editor/index.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在路由匹配组件渲染之前会先执行中间件</span>
  middleware<span class="token operator">:</span> <span class="token string">&quot;authenticated&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h2> <p>我们可以通过插件扩展<code>Nuxt.js</code>的功能</p> <p><img src="/server/plugins.svg" alt=""></p> <p>例如可以扩展<code>axios</code>，添加拦截器在每个请求前请求头添加 token</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// /plugins/request.js</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 创建请求对象</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> request <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token operator">:</span> <span class="token string">&quot;https://conduit.productionready.io&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 'http://realworld.api.fed.lagounews.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过插件机制获取到上下文对象（query、params、req、res、app、store...）</span>
<span class="token comment">// 插件导出函数必须作为 default 成员</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 请求拦截器,任何请求都要经过请求拦截器</span>
  <span class="token comment">// 我们可以在请求拦截器中做一些公共的业务处理,例如统一设置 token</span>
  request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 请求就会经过这里</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Token </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 返回 config 请求配置对象</span>
      <span class="token keyword">return</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果请求失败(此时请求还没有发出去)就会进入这里</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// nuxt.config.js</span>
<span class="token comment">// 注册插件</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;~/plugins/request.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="meta-标签和-seo"><a href="#meta-标签和-seo" class="header-anchor">#</a> meta 标签和 SEO</h2> <p>pages 中添加 head，可以为我们的页面增加 title 和 meta 标签，有助于提升 SEO</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">head</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>article<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - RealWorld</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> hid<span class="token operator">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>article<span class="token punctuation">.</span>description <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="使用-vuex"><a href="#使用-vuex" class="header-anchor">#</a> 使用 Vuex</h2> <p><code>Nuxt.js</code>中已经集成了 Vuex 在 store 目录中定义需要的 <code>state</code>，<code>mutations</code> 和 <code>actions</code> 即可.</p> <p><code>Nuxt.js</code>增加了<code>nuxtServerInit</code>,一个特殊的 action，这个 action 会在服务器渲染期间自动调用，初始化容器数据，传递数据给客户端使用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// store/index.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">nuxtServerInit</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> req <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果请求头中有cookie</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 使用cookieparser把cookie字符串转化为Javascript对象</span>
      <span class="token keyword">const</span> parsed <span class="token operator">=</span> cookieparser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        user <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>parsed<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="使用-nuxtjs-实现-realworld-项目"><a href="#使用-nuxtjs-实现-realworld-项目" class="header-anchor">#</a> 使用 Nuxtjs 实现 realworld 项目</h2> <p>使用 Nuxt.js 完成 realworld 项目，已部署到阿里云 https://realworld.licop.cn/</p> <h2 id="更多参考"><a href="#更多参考" class="header-anchor">#</a> 更多参考</h2> <ul><li><a href="https://zh.nuxtjs.org/docs/2.x/get-started/installation" target="_blank" rel="noopener noreferrer">Nuxtjs 官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/licop/nuxtjs-realworld" target="_blank" rel="noopener noreferrer">使用 Nusxjs 实现 realworld<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/server/ssr/服务器端渲染.html" class="prev">
        服务器端渲染
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.af0360ee.js" defer></script><script src="/assets/js/2.5e2d37c1.js" defer></script><script src="/assets/js/50.a9f91cfe.js" defer></script><script src="/assets/js/3.b304fdc1.js" defer></script>
  </body>
</html>
